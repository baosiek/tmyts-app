<div>
    <div>
        <div>
            <mat-stepper linear #stepper>
                <mat-step [stepControl]="stepOneForm">
                    <form [formGroup]="stepOneForm">
                        <ng-template matStepLabel>Type an investment name or symbol</ng-template>
                        <mat-form-field appearance="outline" style="margin-top: 12px; width: 500px">
                            <mat-label>Symbol or investment</mat-label>
                            <input matInput formControlName="symbol" placeholder="Select a symbol"
                                (keyup)="searchTerm($event)">
                            <mat-icon matSuffix>search_insights</mat-icon>
                        </mat-form-field>
                        @if (searchResults().length > 0){
                        <mat-selection-list [multiple]="false" hideSingleSelectionIndicator #selectedSymbols
                            (selectionChange)="onSymbolSelectionChange(stepper, selectedSymbols.selectedOptions.selected)">
                            @for (result of searchResults(); track result.id) {
                            <mat-list-option [value]="result">
                                <div matListItemTitle>{{result.symbol}}</div>
                                <div matListItemLine>{{result.symbol_name}}</div>
                            </mat-list-option>
                            <mat-divider></mat-divider>
                            }
                        </mat-selection-list>
                        }
                        <div>
                            <button type="button" matButton [mat-dialog-close]="true">Cancel</button>
                            <button type="button" matButton matStepperNext>Next</button>
                        </div>
                    </form>
                </mat-step>
                <mat-step [stepControl]="stepTwoForm">
                    <div class="stock-card">
                        <span>{{selectedSymbol.symbol}}</span>
                        <span>{{selectedSymbol.symbol_name}}</span>
                        <span>{{symbolLiveData().price_close | currency:'USD':'symbol':'1.2-2'}}</span>
                        <span>{{symbolLiveData().difference | currency:'USD':'symbol':'1.2-2' }}</span>
                        <span>{{symbolLiveData().percent | percent:'1.2-2'}}</span>
                    </div>
                    <form [formGroup]="stepTwoForm" class="form-container">
                        <ng-template matStepLabel>Fill transaction information</ng-template>
                        <div>
                            <mat-form-field appearance="outline" class="form-field">
                                <mat-label>Quantity</mat-label>
                                <input matInput type="number" formControlName="quantity" placeholder="0" required
                                    class="right-align">
                            </mat-form-field>
                        </div>
                        <div>
                            <mat-form-field appearance="outline" class="form-field" floatLabel="always">
                                <mat-label>Purchase price</mat-label>
                                <input matInput type="number" formControlName="purchase_price" placeholder="0" required
                                    class="right-align">
                                <span matTextPrefix>$&nbsp;</span>
                            </mat-form-field>
                        </div>
                        <div>
                            <mat-form-field appearance="outline" class="form-field" floatLabel="always">
                                <mat-label>Fees</mat-label>
                                <input matInput type="number" formControlName="fees" placeholder="0" required
                                    class="right-align">
                                <span matTextPrefix>$&nbsp;</span>
                            </mat-form-field>
                        </div>
                        <mat-form-field appearance="outline" class="form-field">
                            <mat-label>Purchase date</mat-label>
                            <input matInput formControlName="purchase_date" [matDatepicker]="picker" required>
                            <mat-hint>MM/DD/YYYY</mat-hint>
                            <mat-datepicker-toggle matIconSuffix [for]="picker"></mat-datepicker-toggle>
                            <mat-datepicker #picker></mat-datepicker>
                        </mat-form-field>

                    </form>
                    <div>
                        <button type="button" matButton matStepperNext [mat-dialog-close]="true">Cancel</button>
                        <button type="button" matButton matStepperPrevious>Back</button>
                        <button type="button" matButton matStepperNext (click)="buyAsset()"
                            [mat-dialog-close]="true">Buy</button>
                    </div>
                </mat-step>
            </mat-stepper>
        </div>
    </div>
</div>